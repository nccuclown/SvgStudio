# SVG編輯器 - 實作邏輯與挑戰

## 當前工作流程

1. **元件解析流程**
   - 解析原始SVG代碼為DOM結構
   - 遍歷DOM樹建立元件結構（SVGComponent）
   - 為沒有ID的元素生成唯一ID
   - 保存元素的屬性和父子關係

2. **屬性修改流程**
   - 用戶在屬性面板選擇元素
   - PropertyPanel 組件觸發屬性變更
   - updateComponentProperty 函數處理更新
   - updateSvgComponent 在SVG中尋找並修改元素

## 主要挑戰

1. **ID生成與對應問題**
   - 原始SVG中的元素可能沒有ID
   - 生成的ID需要與原始SVG的命名約定一致
   - 要保持父子元素ID的關聯性（如 stage3 及其子元素）

2. **元素定位問題**
   - getElementById 可能找不到元素
   - 需要考慮SVG的層級結構
   - 元素的查找需要支持遞歸搜索

3. **屬性更新問題**
   - 不同類型的屬性需要不同的處理方式
   - 要處理樣式屬性的特殊情況
   - 需要驗證更新後的SVG是否有效

## 解決方案嘗試

1. **使用路徑索引**
   - 嘗試使用元素在DOM樹中的路徑來定位
   - 遇到的問題：路徑可能因為DOM結構變化而失效

2. **使用XPath**
   - 考慮使用XPath來定位元素
   - 優點：不依賴ID，可以準確定位元素
   - 待實現

3. **改進ID生成策略**
   - 根據父元素ID生成子元素ID
   - 保持與原始SVG的命名約定一致
   - 正在實現和測試中

## 下一步改進

1. 實現XPath定位元素
2. 改進元件樹的顯示，更清晰地展示層級關係
3. 添加更詳細的錯誤處理和日誌記錄
4. 優化屬性更新的效能和可靠性
